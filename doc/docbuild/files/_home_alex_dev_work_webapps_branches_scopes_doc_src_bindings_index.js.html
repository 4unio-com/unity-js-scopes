<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>/home/alex/dev/work/webapps/branches/scopes/doc/src/bindings/index.js - Javascript Scopes API</title>
    <link rel="stylesheet" href="http://yui.yahooapis.com/3.9.1/build/cssgrids/cssgrids-min.css">
    <link rel="stylesheet" href="../assets/vendor/prettify/prettify-min.css">
    <link rel="stylesheet" href="../assets/css/main.css" id="site_styles">
    <link rel="icon" href="../assets/favicon.ico">
    <script src="http://yui.yahooapis.com/combo?3.9.1/build/yui/yui-min.js"></script>
</head>
<body class="yui3-skin-sam">

<div id="doc">
    <div id="hd" class="yui3-g header">
        <div class="yui3-u-3-4">
                <h1><img src="../assets/css/logo.png" title="Javascript Scopes API" width="117" height="52"></h1>
        </div>
        <div class="yui3-u-1-4 version">
            <em>API Docs for: 0.1</em>
        </div>
    </div>
    <div id="bd" class="yui3-g">

        <div class="yui3-u-1-4">
            <div id="docs-sidebar" class="sidebar apidocs">
                <div id="api-list">
                    <h2 class="off-left">APIs</h2>
                    <div id="api-tabview" class="tabview">
                        <ul class="tabs">
                            <li><a href="#api-classes">Classes</a></li>
                            <li><a href="#api-modules">Modules</a></li>
                        </ul>
                
                        <div id="api-tabview-filter">
                            <input type="search" id="api-filter" placeholder="Type to filter APIs">
                        </div>
                
                        <div id="api-tabview-panel">
                            <ul id="api-classes" class="apis classes">
                                <li><a href="../classes/ActionMetadata.html">ActionMetadata</a></li>
                                <li><a href="../classes/ActivationQuery.html">ActivationQuery</a></li>
                                <li><a href="../classes/CategorisedResult.html">CategorisedResult</a></li>
                                <li><a href="../classes/Category.html">Category</a></li>
                                <li><a href="../classes/CategoryRenderer.html">CategoryRenderer</a></li>
                                <li><a href="../classes/ColumnLayout.html">ColumnLayout</a></li>
                                <li><a href="../classes/PreviewQuery.html">PreviewQuery</a></li>
                                <li><a href="../classes/PreviewReply.html">PreviewReply</a></li>
                                <li><a href="../classes/PreviewWidget.html">PreviewWidget</a></li>
                                <li><a href="../classes/Result.html">Result</a></li>
                                <li><a href="../classes/Scope.html">Scope</a></li>
                                <li><a href="../classes/SearchMetaData.html">SearchMetaData</a></li>
                                <li><a href="../classes/SearchQuery.html">SearchQuery</a></li>
                                <li><a href="../classes/SearchReply.html">SearchReply</a></li>
                            </ul>
                
                            <ul id="api-modules" class="apis modules">
                                <li><a href="../modules/ScopeJS.html">ScopeJS</a></li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="yui3-u-3-4">
                <div id="api-options">
                    Show:
                    <label for="api-show-inherited">
                        <input type="checkbox" id="api-show-inherited" checked>
                        Inherited
                    </label>
            
                    <label for="api-show-protected">
                        <input type="checkbox" id="api-show-protected">
                        Protected
                    </label>
            
                    <label for="api-show-private">
                        <input type="checkbox" id="api-show-private">
                        Private
                    </label>
                    <label for="api-show-deprecated">
                        <input type="checkbox" id="api-show-deprecated">
                        Deprecated
                    </label>
            
                </div>
            
            <div class="apidocs">
                <div id="docs-main">
                    <div class="content">
<h1 class="file-heading">File: /home/alex/dev/work/webapps/branches/scopes/doc/src/bindings/index.js</h1>

<div class="file">
    <pre class="code prettyprint linenums">
/*
 * Copyright 2015 Canonical Ltd.
 *
 * This file is part of unity-js-scopes.
 *
 * unity-js-scopes is free software; you can redistribute it and/or modify
 * it under the terms of the GNU General Public License as published by
 * the Free Software Foundation; version 3.
 *
 * unity-js-scopes is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 * GNU General Public License for more details.
 *
 * You should have received a copy of the GNU General Public License
 * along with this program.  If not, see &lt;http://www.gnu.org/licenses/&gt;.
 */

var lib = require(&#x27;./unity_js_scopes_bindings&#x27;);
var core = require(&#x27;./lib/scope-core.js&#x27;);

// Init the first time it is accessed
var self;

/**
 * Scope corresponds to the bridge between the ubuntu scope runtime
 * and the actual scope.
 * 
 * A Scope object is not directly constructible but it is automatically created
 * when the scope module is imported and is accessible through the &#x27;self&#x27; exported
 * member.
 * 
 * After the scopes runtime has obtained initialization runtime configurations from
 * the scope, it calls start(), which allows the scope to intialize itself. This is
 * followed by a call to run().
 * 
 * When the scope should complete its activities, the runtime calls stop().
 * 
 * @example
      var scopes = require(&#x27;unity-js-scopes&#x27;)
      scopes.self
  
 * @module ScopeJS
 * 
 * 
 * @class Scope
 */
function Scope() {}

Scope.prototype = {
    /**
     * This member function is the entry point to setting up a scope&#x27;s behavior
     * and configuring it to the runtime scope.
     *
     * @method initialize
     * @param options {Object} A dictionary of options for the scope runtime.
     *      The option keys are:
     *         - scope_id: the scope id
     * @param runtime_config {Object} A dictionary of runtime configuration settings for the scope runtime.
     *      The configuration keys are:
     *         - run {Function()}: Callback called by the scopes run time after it has called start() to hand a thread of control to the scope
     *         - starting {Function(String: scope_id)}: Callback called by the scopes run time after the create function completes
     *         - stop {Function()}: Callback called by the scopes run time when the scope should shut down
     *         - search {Function(CannedQuery: canned_query, SearchMetaData: metadata)}: Callback called by the scopes run time when a scope needs to instantiate a query
     *         - perform_action {Function(Result: result, ActionMetaData: metadata, String: widget_id, String: ation_id)}: Callback invoked when a scope is requested to handle a preview action
     *         - preview {Function(Result: result, ActionMetaData: metadata)}: Callback invoked when a scope is requested to create a preview for a particular result
     *
     * @example
              var scopes = require(&#x27;unity-js-scopes&#x27;)
              scopes.self.initialize(
                {}, {
                  run: function() {}
                  start: function(scope_id) {
                    console.log(&#x27;Starting scope id: &#x27;
                      + scope_id
                      + &#x27;, &#x27;
                      + scopes.self.scope_config)
                  },
                  search: function(canned_query, metadata) {}
                }
              );
    */
    initialize: function(options, runtime_config) {
        this._setup_backend();

        if (! options || typeof(options) !== &#x27;object&#x27;) {
            throw &quot;No or invalid options specified&quot;;
        }
        
        if (! runtime_config || typeof(runtime_config) !== &#x27;object&#x27;) {
            throw &quot;No or invalid runtime configuration specified&quot;;
        }

        if (runtime_config.run &amp;&amp; typeof(runtime_config.run) === &#x27;function&#x27;) {
            this._base.onrun(runtime_config.run);
        }

        if (runtime_config.start &amp;&amp; typeof(runtime_config.start) === &#x27;function&#x27;) {
            this._base.onstart(runtime_config.start);
        }

        if (runtime_config.stop &amp;&amp; typeof(runtime_config.stop) === &#x27;function&#x27;) {
            this._base.onstop(runtime_config.stop);
        }

        if (runtime_config.search &amp;&amp; typeof(runtime_config.search) === &#x27;function&#x27;) {
            this._base.onsearch(runtime_config.search);
        }

        if (runtime_config.preview &amp;&amp; typeof(runtime_config.preview) === &#x27;function&#x27;) {
            this._base.onpreview(runtime_config.preview);
        }

        if (runtime_config.activate &amp;&amp; typeof(runtime_config.activate) === &#x27;function&#x27;) {
            // this._base.onactivate(runtime_config.activate);
        }

        return this._scope_binding.run(
            options &amp;&amp; options.scope_id ? options.scope_id : &quot;&quot;);
    },
    _setup_backend: function(options) {
        if (! this._scope_binding) {
            this._scope_binding = core.new_scope(options ? options.runtime_config : &quot;&quot;);
            this._base = this._scope_binding.scope_base();
        }
    },
    /**
     * Returns the directory that stores the scope&#x27;s configuration files and shared library    
     *
     * @property scope_directory
     */
    get scope_directory() {
        return this._base.scope_directory();
    },
    /**
     * Returns a directory that is (exclusively) writable for the scope
     *
     * @property cache_directory
     */
    get cache_directory() {
        return this._base.cache_directory();
    },
    /**
     * Returns a tmp directory that is (exclusively) writable for the scope
     * 
     * @property tmp_directory
     */
    get tmp_directory() {
        return this._base.tmp_directory();
    },
    /**
     * Returns the scope registry
     * 
     * @property registry
     */
    get registry() {
        return null
    },
    /**
     * Returns a dictionary with the scope&#x27;s current settings
     * 
     * @property settings
     */
    get settings() {
        return this._base.settings();
    },
};

ConnectivityStatus = {
    Unknown: &quot;Unknown&quot;,
    Connected: &quot;Connected&quot;,
    Disconnected: &quot;Disconnected&quot;
};

var PostLoginAction = {
    Unknown: &quot;Unknown&quot;,
    DoNothing: &quot;DoNothing&quot;,
    InvalidateResults: &quot;InvalidateResults&quot;,
    ContinueActivation: &quot;ContinueActivation&quot;
};

module.exports = {
    lib: lib,
    defs: {
        PostLoginAction: PostLoginAction,
        ConnectivityStatus: ConnectivityStatus
    }
}

Object.defineProperty(
    module.exports,
    &quot;self&quot;,
    {
        get: function() {
            if (! self) {
                self = new Scope();
            }
            return self;
        },
    });

    </pre>
</div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<script src="../assets/vendor/prettify/prettify-min.js"></script>
<script>prettyPrint();</script>
<script src="../assets/js/yui-prettify.js"></script>
<script src="../assets/../api.js"></script>
<script src="../assets/js/api-filter.js"></script>
<script src="../assets/js/api-list.js"></script>
<script src="../assets/js/api-search.js"></script>
<script src="../assets/js/apidocs.js"></script>
</body>
</html>
